<{include file="./tpl/Cms/Public/header.html" /}>
<body>
    <div id="wrapper">
    <{include file="./tpl/Cms/Public/left.html" /}>


<link rel="stylesheet" href="__PUBLIC_CSS__/home/Form/teamwork.css">
<link rel="stylesheet" href="__PUBLIC_CSS__/home/Form/zyupload-1.0.0.min.css">

<div class="row wrapper border-bottom white-bg page-heading">
    <div class="col-lg-10">
        <h2>空间合作</h2>
        <ol class="breadcrumb">
            <li>
                <a href="index.html">空间管理</a>
            </li>
            <li>
                <a>空间合作</a>
            </li>
            <li>
                <strong>空间编辑</strong>
            </li>
        </ol>
    </div>
    <div class="col-lg-2">

    </div>

    <div class="wrapper wrapper-content animated fadeInRight">
        <div class="row">
            <div class="col-lg-12">
                <div class="ibox float-e-margins">
                    <div class="ibox-title">
                        <h5>编辑空间信息 <small>请谨慎处理</small></h5>
                        <div class="ibox-tools">
                            <a class="collapse-link">
                                <i class="fa fa-chevron-up"></i>
                            </a>
                            <a class="dropdown-toggle" data-toggle="dropdown" href="form_basic.html#">
                                <i class="fa fa-wrench"></i>
                            </a>
                            <!-- <ul class="dropdown-menu dropdown-user">
                                <li><a href="form_basic.html#">选项1</a>
                                </li>
                                <li><a href="form_basic.html#">选项2</a>
                                </li>
                            </ul> -->
                            <a class="close-link">
                                <i class="fa fa-times"></i>
                            </a>
                        </div>
                    </div>
<!-- ==========================正文表单=============================== -->
    <div class="ibox-content">
        <form method="post" class="form-horizontal" action="__URL__/modifyForm" enctype="multipart/form-data">
            <input type="hidden" name="id" value="<--{$list.id}-->">
            <div class="form-group">
                <label class="col-sm-2 control-label">空间头像</label>
                <div class="col-sm-10">
                    <span>
                        <img class="img-circle" width="64" height="64" src="__ROOT__/<--{$list.logo}-->">
                    </span><p>
                    <input type="hidden" value="<--{$list.logo}-->" name="old_logo">
                    <div  class="col-sm-10">
                        <input id="" type="file" value="" name="logo">
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label class="col-sm-2 control-label">空间名称</label>
                <div class="col-sm-10">
                    <input type="text" class="form-control" value="<--{$list.name}-->" style="width:500px;" name="name">
                </div>
            </div>
            <div class="hr-line-dashed"></div>
            <div class="form-group">
                <label class="col-sm-2 control-label">空间描述</label>
                <div class="col-sm-10">
                    <input type="text" placeholder="请简述一下贵公司的空间情况。（100字以上）" class="form-control" style="width:500px;height:100px" value="<--{$list.desc}-->" name="desc">
                </div>
            </div>

            <div class="form-group">
                <label class="col-sm-2 control-label">优惠政策</label>
                <div class="col-sm-10">
                    <input type="text" placeholder="可选" class="form-control" style="width:500px;height:100px" value="<--{$list.privile}-->" name="privile">
                </div>
            </div>

            <div class="form-group">
                <style type="text/css">
                    .zyupload{
                        margin-left:-5px;
                    }
                    .zyupload .upload_choose{
                        height: 150px;
                    }
                </style>
                <input type="hidden" id="url_add" value="__URL__/addPicFile/rid/<--{$list.id}-->">
                <input type="hidden" id="roomid" value="<--{$list.id}-->">
                <input type="hidden" id="url_piclist" value="__ROOT__/Cms/Symbiosis/getSlidePicList">
                 <input type="hidden" id="url_del" value="__ROOT__/Cms/Symbiosis/delPicFile">
                <div class="te-uploads">
                    <label class="col-sm-2 control-label">上传空间图片：
                    </label>
                    <div class="col-sm-10">
                        <div id="zyupload" class="zyupload"></div>
                        <div class="te-room-error">
                            <p class="te-image-error"></p>
                            <p> 请至少上传一张照片</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label class="col-sm-2 control-label">空间位置</label>
                <div class="row">
                    <div class="col-md-1">
                        <select class="form-control m-b prov" id="prov" name="prov" style="width:90px" >
                            <{volist name="AreaProv"  id="prov"}>
                                <{if condition="$list.province == $prov"}>
                                    <option value="<--{$prov}-->" selected="">
                                        <--{$prov}-->
                                    </option>
                                <{else /}>
                                    <option value="<--{$prov}-->">
                                        <--{$prov}-->
                                    </option>
                                <{/if}>
                            <{/volist}>
                        </select>
                    </div>
                    <div class="col-md-1">
                        <select class="form-control m-b city" name="city" style="width:90px" id="city">
                            <option value="<--{$list.city}-->">
                                <--{$list.city}-->
                            </option>
                        </select>
                    </div>
                    <div class="col-md-1">
                        <select class="form-control m-b dist" name="dist" style="width:90px" id="dist">
                            <option value="<--{$list.district}-->">
                                <--{$list.district}-->
                            </option>
                        </select>
                    </div>
                    <input type="hidden" value="__ROOT__/Home/Index/getAreaInfo" id="areaurl">
                </div>
            </div>
        <div class="form-group">
            <label class="col-sm-2 control-label">详细地址</label>
            <div class="col-sm-10">
                <input type="text" placeholder="不能为空或少于6个字" class="form-control" style="width:500px;" value="<--{$list.addr}-->" name="addr">
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-2 control-label">负责人</label>
            <div class="col-sm-10">
                <input type="text" placeholder="不能为空或少于2个字" class="form-control" style="width:500px;" value="<--{$list.linkman}-->" name="linkman">
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-2 control-label">手机号</label>
            <div class="col-sm-10">
                <input type="text" placeholder="请填写正确的电话或手机号" class="form-control" style="width:500px;" value="<--{$list.mobile}-->" name="mobile">
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-2 control-label">优势特色</label>
            <div class="col-sm-10">
            <{volist name="Ptags" id="p_tag"}>
                <label class="checkbox-inline">
                    <input type="checkbox" value="<--{$p_tag.id}-->" id="inlineCheckbox<--{$p_tag.name}-->" name="advantage[]"
                    <{in name="p_tag.id" value="$Stags"}>
                        checked="checked"
                    <{/in}>
                    ><--{$p_tag.name}-->
                </label>
            <{/volist}>
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-2 control-label">每工位价格</label>
            <div class="col-sm-10">
                <input type="text" class="form-control" value="<--{$list.station}-->" style="width:100px;" name="station"> &nbsp;元/月
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-2 control-label">每平米价格</label>
            <div class="col-sm-10">
                <input type="text" class="form-control" value="<--{$list.square}-->" style="width:100px;" name="square">&nbsp;元/天
            </div>
        </div>
        <div class="form-group">
            <div class="col-sm-4 col-sm-offset-2">
                <button class="btn btn-primary" type="submit">提交保存</button>
            </div>
        </div>
    </form>
</div>
<!-- ==========================我是分隔线=============================== -->
            </div>
        </div>
    </div>
</div>
<{include file="./tpl/Cms/Public/footer_us.html" /}>
        </div>
    </div>
</div>
<{include file="./tpl/Cms/Public/footer.html" /}>
<script type="text/javascript" src="__PUBLIC_JS__/home/zyupload-1.0.0.min.js"></script>
<script type="text/javascript" src="__PUBLIC_JS__/home/teamwork.js"></script>
<script type="text/javascript">
    //页面加载时需装载的内容
    /**
     * [页面自动加截空间图片]
     * @method
     * @author 大业
     * @create 2016-08-26
     * @return {[type]} [description]
     */
    $(document).ready(function(){
        window.funBindHoverEvent = function () {
            $(".upload_append_list").hover(function (e) {
                $(this).find(".file_bar").addClass("file_hover")
            }, function (e) {
                $(this).find(".file_bar").removeClass("file_hover")
            })
        };

        var url     = $("#url_piclist").val();
        var roomid  = $("#roomid").val();
        $.ajax({
            type: "POST",
            url: url,
            data: {'id':roomid},
            dataType: "json",
            success: function(e){
                $("#preview").html(e.data);
                funBindHoverEvent()
            }
        });

    });



    /**
     * [删除图片文件]
     * @method delFile
     * @author 大业
     * @create 2016-08-26
     * @param  {[obj]} obj [对象]
     * @param  {[int]} id [图片ID]
     * @return {[type]} [description]
     */
    function delFile(obj,id){
        var delurl  = $("#url_del").val();
        var roomid  = $("#roomid").val();
        var delfile = $("#file_name_"+id).val();
        $.ajax({
            type: "POST",
            url: delurl,
            data: {'id':id,'roomid':roomid,'delfile':delfile},
            dataType: "json",
            success: function(e){
                alert('文件['+e.data+'] '+e.msg);
            }
        });
        //清空删除文件
        $("#uploadList_"+id).removeClass("upload_append_list").html('');

    }


    /**
     * [三级联动地图]
     * @type {[type]}
     */
    var areaurl= $("#areaurl").val();
    /*改变省份时*/
    $(".prov").change(function(){
        /*市:city */
        queryArea(areaurl,$(".prov").val(),1,".city");

        /*区:dist*/
        setTimeout('queryArea(areaurl,$(".city").val(),2,".dist")',100);
    });

    /*改变城市时*/
    $(".city").change(function(){
        /*区:dist*/
        queryArea(areaurl,$(".city").val(),2,".dist");
        /*查询内容*/
        setTimeout('showInfo(showurl);',200);
    });

    /*改变县区*/
    $(".dist").change(function(){
        /*查询内容*/
        setTimeout('showInfo(showurl);',200);
    });

    /**
     * [查询地图信息]
     * @method queryArea
     * @author 大业
     * @create 2016-08-19
     * @param  {[string]} url [访问地址]
     * @param  {[string]} name [地区名称]
     * @param  {[int]} type [地区类型]
     * @param  {[string]} key [要修改的class]
     * @return {[int]} [0]
     */
    function queryArea(url,name,type,key)
    {
        $.ajax({
            type: "POST",
            url: url,
            data: {'name':name,'type':type,'mark':1},
            dataType: "json",
            success: function(e){
                var html = '';
                $.each(e.data,function(k,v){
                    html +="<option id="+key.substr(1)+"_"+k+" value='"+v+"'>"+v+"</option>";
                });
                $(key).html(html);
            }
        });
        return 0;
    }
</script>



